# Malware-Analysis-and-Detection

## Introduction
Malware research is a very dynamic field given the ever changing security landscape in the modern day. Security against malicious software such as viruses, worms, Trojan horses, etc. requires continual improvement or even novel methods to improve the detection of such software. Several proposed mechanisms have been implemented, but often significantly lack automation capability. This has motivated researchers over the years to look into implementations leveraging areas of machine learning such as Deep learning. In this project, two convolutional neural networks were implemented to study their detection accuracy given differences in their depths and hyperparameters.

### Preliminary remarks
This repository contains live windows portable executable malware samples in the passowrd protected archive named samples.7z, the password is "infected". I will not be held liable for any damage that may occur from mishandling the samples. You have been warned! To extract the samples from the archive you can use the following command:

```
7z x samples.7z -pinfected
```

---

### Data processing
Scripts written in bash and python are provided in the scripts directory for the purposes of converting the malware binaries into images, splitting the images into training, validation and testing datasets. [imauto.sh](https://github.com/lehasaS/Malware-Analysis-and-Detection/blob/master/scripts/imauto.sh) is provided for automating the conversion, and [split.sh](https://github.com/lehasaS/Malware-Analysis-and-Detection/blob/master/scripts/split.sh) is provided for automating the splitting the dataset.

---
### Running the program
#### Using make
A [Makefile](https://github.com/lehasaS/Malware-Analysis-and-Detection/blob/master/Makefile) is provided should you wish to use it for running the program. Note that calling make creates a python environment for you assuming you do not have one, and also installs the neccessary packages specified in the requirements.txt file. training, testing, and clean commands are provided in the file and can be executed by:

```
make <command_name>
```

#### Using command line
You are required to first install the necesaary packages needed to run the program, this can be done with the following command:

```
pip install -r requirements.txt
```

You can then run execute the following command to train or test the models:

```
python CNN_Malware_Train_Test.py <flag> <model_name>
```

Where flag must either be:
- --train (For training a model, requires a train_output directory in the root directory to save all the files generated, including the state dict of the model)
- --test (For testing a model,requires a test_output directory in the root directory to save all the files generated)

Where model_name must either be:
- Model_One
- Model_Two

---
### Hyperparameter Tuning
Hyperparameter tuning is done on the platform weights and biases, if you wish to do this yourself. The notebook [CNN_Malware_Hyperparameter_Study.ipynb](https://github.com/lehasaS/Malware-Analysis-and-Detection/blob/master/CNN_Malware_Hyperparameter_Study.ipynb) is provided.
