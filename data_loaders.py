import torch
import torchvision
import torchvision.transforms

def get_image_data_loaders(image_dim, batch_size):
    train_dir = 'output/train'
    val_dir = 'output/val'
    test_dir ='output/test'

    transform = torchvision.transforms.Compose([
            torchvision.transforms.Grayscale(),
            torchvision.transforms.Resize((image_dim,image_dim)),
            torchvision.transforms.ToTensor()
        ])

    training_dataset = torchvision.datasets.ImageFolder(train_dir, transform=transform)
    test_dataset = torchvision.datasets.ImageFolder(test_dir, transform=transform)
    val_dataset = torchvision.datasets.ImageFolder(val_dir, transform=transform)

    train_loader = torch.utils.data.DataLoader(training_dataset, batch_size=batch_size, num_workers=0)
    test_loader = torch.utils.data.DataLoader(test_dataset, batch_size=batch_size, num_workers=0)
    val_loader = torch.utils.data.DataLoader(val_dataset, batch_size=batch_size, num_workers=0)

    return train_loader, val_loader, test_loader