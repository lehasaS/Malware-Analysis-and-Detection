# Lehasa Seoe
# 25 August 2022
# Script to split folders
import pathlib
import os
import sys
import splitfolders


def main(filepath):
    print("===================== Preparing to split files =====================")
    splitfolders.ratio(filepath, output="output", seed=1337, ratio=(.8, 0.1, 0.1))
    data_dir = pathlib.Path(os.path.normpath('output'))
    train_path = data_dir / "train"
    val_path = data_dir / "val"
    print("===================== Done =====================")
    malware_train = len(os.listdir(train_path / "malware"))
    benign_train = len(os.listdir(train_path / "benign"))
    malware_valid = len(os.listdir(val_path / "malware"))
    benign_valid = len(os.listdir(val_path / "benign"))
    print("===================== Number of files in each folder  =====================")
    print("Malware Train Images: {}".format(malware_train))
    print("Benign Train Images: {}".format(benign_train))
    print("Malware Validation Images: {}".format(malware_valid))
    print("Benign Validation Images: {}".format(benign_valid))


if __name__ == "__main__":
    if len(sys.argv) == 2:
        main(sys.argv[1])
    else:
        print("===================== Input format error! =====================")
        print("Expected: python3 data_processing.py <Data directory name>")
